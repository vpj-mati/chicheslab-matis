<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
</head>
<body>
    <h1>Ejemplo JAVA SCRIPT</h1>

    <script>
        
        const alicIva = 0.105;
        const factorCorIIBB = 0.8;
        const sellado = 70;

        var totalPEE;
        var precioGrano;
        var cantidadGrano;
    
        var TotalesFacturas = [];

        var factura = { fechaVto: "30-11-2023", numeroFactura: "0001A00001234", importe: 50000, difCambio: 90, percIva: 500 };
        var factura1 = { fechaVto: "30-11-2023", numeroFactura: "0001A00001234", importe: 25000, difCambio: 10, percIva: 250 };
        var factura2 = { fechaVto: "30-11-2023", numeroFactura: "0001A00001234", importe: 25000, difCambio: 10, percIva: 250 };

        TotalesFacturas.push(factura);
        TotalesFacturas.push(factura1);
        TotalesFacturas.push(factura2);
        
        var sumaFacturas = 0;
        var sumaDifCambio = 0;
        var sumaPercIva = 0;

        for (let i = 0; i < TotalesFacturas.length; i++) {
            sumaFacturas = sumaFacturas + TotalesFacturas[i].importe;
            sumaDifCambio = sumaDifCambio + TotalesFacturas[i].difCambio;
            sumaPercIva = sumaPercIva + TotalesFacturas[i].percIva;
        }
       
        totalPEE = sumaFacturas + sumaDifCambio + sumaPercIva + sellado;

        precioGrano = 65000;

        var comision = 0.015;
        var flete = 5500;
        var grado = 3;
        var valorGrado;
        var alicIIBB = 0.008;
        var tipoGrano = "Trigo";


        if(grado == 1)
        {
            if(tipoGrano == "Trigo")
            {
                valorGrado = 0.015;
            }
            else
            {
                valorGrado = 0.01;
            }   
        }

        if(grado == 2)
        {
            valorGrado = 0;
        }
        
        if(grado == 3)
        {
            if(tipoGrano == "Trigo")
            {
                valorGrado = -0.01;
            }
            else
            {
                valorGrado = -0.015;
            }   
        }
        
        
        var factor = 100;
        var valorFactor = factor / 100;
        var precioCalidad = precioGrano * (1 + valorGrado) * valorFactor;
        var precioOperacion = precioCalidad - precioGrano * comision - flete;
        var precioIIBB = precioGrano * valorFactor + precioGrano * valorGrado
        var precioFinal = precioOperacion * (1 + alicIva) - precioIIBB * (1 + alicIva) * factorCorIIBB * alicIIBB;
        

        cantidadGrano = totalPEE / precioFinal;
        console.log("Total a liquidar: " + cantidadGrano.toFixed(3) + "tn");

    </script>
    
</body>
</html>